

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>WIND SPEED &#8212; Parcial ML</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Parcial Wind Speed';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Ejericio 4 - EDA" href="Fraud%20Detection.html" />
    <link rel="prev" title="Welcome to your Jupyter Book" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/Logo_uninorte.jpg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/Logo_uninorte.jpg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">WIND SPEED</a></li>

<li class="toctree-l1"><a class="reference internal" href="Fraud%20Detection.html">Ejericio 4 - EDA</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FParcial Wind Speed.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Parcial Wind Speed.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>WIND SPEED</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">WIND SPEED</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-4-eda">Ejercicio 4 - EDA</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-6-modelos-de-regresion">Ejercicio 6 - Modelos de Regresión</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#validacion-mejor-modelo">Validación Mejor Modelo</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="wind-speed">
<h1>WIND SPEED<a class="headerlink" href="#wind-speed" title="Permalink to this heading">#</a></h1>
<section id="ejercicio-4-eda">
<h2>Ejercicio 4 - EDA<a class="headerlink" href="#ejercicio-4-eda" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_treino</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">Users</span><span class="se">\\</span><span class="s1">Andres</span><span class="se">\\</span><span class="s1">Downloads</span><span class="se">\\</span><span class="s1">data_treino_dv_df_2000_2010.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="n">df_treino</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>HORA (UTC)</th>
      <th>VENTO, DIREï¿½ï¿½O HORARIA (gr) (ï¿½ (gr))</th>
      <th>VENTO, VELOCIDADE HORARIA (m/s)</th>
      <th>UMIDADE REL. MAX. NA HORA ANT. (AUT) (%)</th>
      <th>UMIDADE REL. MIN. NA HORA ANT. (AUT) (%)</th>
      <th>TEMPERATURA Mï¿½XIMA NA HORA ANT. (AUT) (ï¿½C)</th>
      <th>TEMPERATURA Mï¿½NIMA NA HORA ANT. (AUT) (ï¿½C)</th>
      <th>UMIDADE RELATIVA DO AR, HORARIA (%)</th>
      <th>PRESSAO ATMOSFERICA AO NIVEL DA ESTACAO, HORARIA (mB)</th>
      <th>PRECIPITAï¿½ï¿½O TOTAL, HORï¿½RIO (mm)</th>
      <th>VENTO, RAJADA MAXIMA (m/s)</th>
      <th>PRESSï¿½O ATMOSFERICA MAX.NA HORA ANT. (AUT) (mB)</th>
      <th>PRESSï¿½O ATMOSFERICA MIN. NA HORA ANT. (AUT) (mB)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12:00</td>
      <td>0.809017</td>
      <td>1.8</td>
      <td>69.0</td>
      <td>60.0</td>
      <td>22.6</td>
      <td>20.7</td>
      <td>61.0</td>
      <td>888.2</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>888.2</td>
      <td>887.7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13:00</td>
      <td>0.965926</td>
      <td>2.7</td>
      <td>62.0</td>
      <td>55.0</td>
      <td>24.2</td>
      <td>22.5</td>
      <td>55.0</td>
      <td>888.4</td>
      <td>0.0</td>
      <td>4.7</td>
      <td>888.4</td>
      <td>888.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14:00</td>
      <td>0.891007</td>
      <td>2.0</td>
      <td>56.0</td>
      <td>50.0</td>
      <td>25.5</td>
      <td>24.3</td>
      <td>51.0</td>
      <td>888.1</td>
      <td>0.0</td>
      <td>4.9</td>
      <td>888.4</td>
      <td>888.1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15:00</td>
      <td>0.848048</td>
      <td>2.5</td>
      <td>52.0</td>
      <td>44.0</td>
      <td>27.4</td>
      <td>25.0</td>
      <td>44.0</td>
      <td>887.4</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>888.1</td>
      <td>887.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16:00</td>
      <td>0.224951</td>
      <td>2.4</td>
      <td>50.0</td>
      <td>43.0</td>
      <td>27.1</td>
      <td>25.5</td>
      <td>46.0</td>
      <td>886.5</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>887.4</td>
      <td>886.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Se relacionan los primeros registros del dataframe donde se puede validar las variables en cada columna.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_treino</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;v1&quot;</span><span class="p">,</span> <span class="s2">&quot;v2&quot;</span><span class="p">,</span> <span class="s2">&quot;v3&quot;</span><span class="p">,</span> <span class="s2">&quot;v4&quot;</span><span class="p">,</span> <span class="s2">&quot;v5&quot;</span><span class="p">,</span> <span class="s2">&quot;v6&quot;</span><span class="p">,</span> <span class="s2">&quot;v7&quot;</span><span class="p">,</span> <span class="s2">&quot;v8&quot;</span><span class="p">,</span> <span class="s2">&quot;v9&quot;</span><span class="p">,</span> <span class="s2">&quot;v10&quot;</span><span class="p">,</span> <span class="s2">&quot;v11&quot;</span><span class="p">,</span> <span class="s2">&quot;v12&quot;</span><span class="p">,</span> <span class="s2">&quot;v13&quot;</span><span class="p">]</span>
<span class="n">df_treino</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>v1</th>
      <th>v2</th>
      <th>v3</th>
      <th>v4</th>
      <th>v5</th>
      <th>v6</th>
      <th>v7</th>
      <th>v8</th>
      <th>v9</th>
      <th>v10</th>
      <th>v11</th>
      <th>v12</th>
      <th>v13</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12:00</td>
      <td>0.809017</td>
      <td>1.8</td>
      <td>69.0</td>
      <td>60.0</td>
      <td>22.6</td>
      <td>20.7</td>
      <td>61.0</td>
      <td>888.2</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>888.2</td>
      <td>887.7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13:00</td>
      <td>0.965926</td>
      <td>2.7</td>
      <td>62.0</td>
      <td>55.0</td>
      <td>24.2</td>
      <td>22.5</td>
      <td>55.0</td>
      <td>888.4</td>
      <td>0.0</td>
      <td>4.7</td>
      <td>888.4</td>
      <td>888.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14:00</td>
      <td>0.891007</td>
      <td>2.0</td>
      <td>56.0</td>
      <td>50.0</td>
      <td>25.5</td>
      <td>24.3</td>
      <td>51.0</td>
      <td>888.1</td>
      <td>0.0</td>
      <td>4.9</td>
      <td>888.4</td>
      <td>888.1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15:00</td>
      <td>0.848048</td>
      <td>2.5</td>
      <td>52.0</td>
      <td>44.0</td>
      <td>27.4</td>
      <td>25.0</td>
      <td>44.0</td>
      <td>887.4</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>888.1</td>
      <td>887.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16:00</td>
      <td>0.224951</td>
      <td>2.4</td>
      <td>50.0</td>
      <td>43.0</td>
      <td>27.1</td>
      <td>25.5</td>
      <td>46.0</td>
      <td>886.5</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>887.4</td>
      <td>886.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Covertimos la variable V1 a numérica.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_treino</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_treino</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_treino</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   v1        v2   v3    v4    v5    v6    v7    v8     v9  v10  v11    v12  \
0  12  0.809017  1.8  69.0  60.0  22.6  20.7  61.0  888.2  0.0  3.8  888.2   
1  13  0.965926  2.7  62.0  55.0  24.2  22.5  55.0  888.4  0.0  4.7  888.4   
2  14  0.891007  2.0  56.0  50.0  25.5  24.3  51.0  888.1  0.0  4.9  888.4   
3  15  0.848048  2.5  52.0  44.0  27.4  25.0  44.0  887.4  0.0  5.8  888.1   
4  16  0.224951  2.4  50.0  43.0  27.1  25.5  46.0  886.5  0.0  5.8  887.4   

     v13  
0  887.7  
1  888.2  
2  888.1  
3  887.4  
4  886.5  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_treino</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 87693 entries, 0 to 87692
Data columns (total 13 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   v1      87693 non-null  int32  
 1   v2      87693 non-null  float64
 2   v3      87693 non-null  float64
 3   v4      87693 non-null  float64
 4   v5      87693 non-null  float64
 5   v6      87693 non-null  float64
 6   v7      87693 non-null  float64
 7   v8      87693 non-null  float64
 8   v9      87693 non-null  float64
 9   v10     87693 non-null  float64
 10  v11     87693 non-null  float64
 11  v12     87693 non-null  float64
 12  v13     87693 non-null  float64
dtypes: float64(12), int32(1)
memory usage: 8.4 MB
</pre></div>
</div>
</div>
</div>
<p>Se describe un DataFrame con 13 columnas y 87693 filas. Las columnas contienen datos de diferentes tipos, principalmente float64 (números decimales) y una columna de tipo objeto (posiblemente texto u otros datos no numéricos)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_treino</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(87693, 13)
</pre></div>
</div>
</div>
</div>
<p>Dimensión del dataframe relacionando cantidad de obsevaciones y variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_treino</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>v1</th>
      <th>v2</th>
      <th>v3</th>
      <th>v4</th>
      <th>v5</th>
      <th>v6</th>
      <th>v7</th>
      <th>v8</th>
      <th>v9</th>
      <th>v10</th>
      <th>v11</th>
      <th>v12</th>
      <th>v13</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>11.506437</td>
      <td>0.405810</td>
      <td>2.466192</td>
      <td>69.058465</td>
      <td>63.176194</td>
      <td>21.921264</td>
      <td>20.684570</td>
      <td>66.146682</td>
      <td>887.251925</td>
      <td>0.160907</td>
      <td>5.161076</td>
      <td>887.580724</td>
      <td>886.891093</td>
    </tr>
    <tr>
      <th>std</th>
      <td>6.932300</td>
      <td>0.686247</td>
      <td>1.313968</td>
      <td>19.640222</td>
      <td>20.166336</td>
      <td>3.721386</td>
      <td>3.513744</td>
      <td>19.992327</td>
      <td>4.012404</td>
      <td>1.307515</td>
      <td>2.311157</td>
      <td>3.646750</td>
      <td>3.564539</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>-1.000000</td>
      <td>0.000000</td>
      <td>12.000000</td>
      <td>10.000000</td>
      <td>9.200000</td>
      <td>8.400000</td>
      <td>10.000000</td>
      <td>863.400000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>865.300000</td>
      <td>862.800000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>5.000000</td>
      <td>-0.156434</td>
      <td>1.500000</td>
      <td>54.000000</td>
      <td>48.000000</td>
      <td>19.200000</td>
      <td>18.400000</td>
      <td>51.000000</td>
      <td>885.300000</td>
      <td>0.000000</td>
      <td>3.400000</td>
      <td>885.600000</td>
      <td>885.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>12.000000</td>
      <td>0.788011</td>
      <td>2.400000</td>
      <td>72.000000</td>
      <td>64.000000</td>
      <td>21.400000</td>
      <td>20.200000</td>
      <td>68.000000</td>
      <td>887.200000</td>
      <td>0.000000</td>
      <td>5.000000</td>
      <td>887.500000</td>
      <td>886.900000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>18.000000</td>
      <td>0.970296</td>
      <td>3.400000</td>
      <td>87.000000</td>
      <td>80.000000</td>
      <td>24.700000</td>
      <td>23.100000</td>
      <td>84.000000</td>
      <td>889.100000</td>
      <td>0.000000</td>
      <td>6.800000</td>
      <td>889.300000</td>
      <td>888.800000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>23.000000</td>
      <td>1.000000</td>
      <td>10.000000</td>
      <td>100.000000</td>
      <td>98.000000</td>
      <td>35.300000</td>
      <td>34.400000</td>
      <td>99.000000</td>
      <td>1023.500000</td>
      <td>70.800000</td>
      <td>24.300000</td>
      <td>913.100000</td>
      <td>910.900000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Se agrega la descripción estadística de los datos, donde se relaciona la cantidad de registros, la media, desv. estándar, míninmos, máximos y percentiles.</p>
<p>Cuando la media es menor que la moda, tenemos una distribución asimétrica hacia la izquierda, donde la mayoría de los valores se encuentran en el lado derecho de la distribución y la cola izquierda es más larga. Y viceversa cuando la media es mayor a la moda.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_treino</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>v1      24
v2     290
v3      89
v4      89
v5      89
v6     251
v7     247
v8      90
v9     446
v10    154
v11    176
v12    415
v13    425
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Validamos la cantidad de registros únicos en cada columna del DataFrame</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_treino</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>v1     0
v2     0
v3     0
v4     0
v5     0
v6     0
v7     0
v8     0
v9     0
v10    0
v11    0
v12    0
v13    0
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">df_treino</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_treino</span><span class="p">)))</span><span class="o">*</span><span class="mi">100</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>v1     0.0
v2     0.0
v3     0.0
v4     0.0
v5     0.0
v6     0.0
v7     0.0
v8     0.0
v9     0.0
v10    0.0
v11    0.0
v12    0.0
v13    0.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Se verifica que el DataFrame no contenga valores nulos, en este caso, todos cumplen con el parámetro.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">correlation_matrix</span> <span class="o">=</span> <span class="n">df_treino</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">correlation_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matriz de Correlación&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d50ede877e4581d760f6179b7840b14d9aec1580e3f432f4aa1d6fa9658e2ee5.png" src="_images/d50ede877e4581d760f6179b7840b14d9aec1580e3f432f4aa1d6fa9658e2ee5.png" />
</div>
</div>
<p>Se realiza un análisis de Independienca de las variables de DataFrame. La validación se realiza a través de una matriz de correlación, las variables independientes serán aquellas con valores cercanos a cero. Tendríamos en este caso: <strong>v1</strong>, <strong>v2</strong>, <strong>v10</strong>, <strong>v13</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variablerspta</span> <span class="o">=</span> <span class="s1">&#39;v3&#39;</span>
<span class="n">variablesind</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">,</span><span class="s1">&#39;v2&#39;</span><span class="p">,</span> <span class="s1">&#39;v10&#39;</span><span class="p">,</span> <span class="s1">&#39;v13&#39;</span><span class="p">]</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df_treino</span><span class="p">[</span><span class="n">variablerspta</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Vento, Velocidade Horaria&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histograma con Curva de Densidad de v3&#39;</span><span class="p">)</span>  

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ff9137cb55886aa41c70aedcba92eb709c5f06c3322340814a27424ef62ac1e7.png" src="_images/ff9137cb55886aa41c70aedcba92eb709c5f06c3322340814a27424ef62ac1e7.png" />
</div>
</div>
<p>Se realiza histograma de la variable respuesta y, ‘<strong>VENTO, VELOCIDAD HORARIA</strong>’. Se puede observar que los datos están ligeramente sesgados a la derecha.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">num_cols</span> <span class="o">=</span> <span class="n">df_treino</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="s1">&#39;int64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">1.4</span><span class="p">)</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">variablesind</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Column: &#39;</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Skew:&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">df_treino</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">skew</span><span class="p">(),</span> <span class="mi">2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Kurtosis: &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">df_treino</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">(),</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">df_treino</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>  
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histograma&#39;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_treino</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Boxplot&#39;</span><span class="p">)</span>
     
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  v1
Skew: -0.0
Kurtosis:  -1.21
</pre></div>
</div>
<img alt="_images/1d724757b876ff22a3f2bccf3cc1b1add768f2b46846c6820248dc8101169d2e.png" src="_images/1d724757b876ff22a3f2bccf3cc1b1add768f2b46846c6820248dc8101169d2e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  v2
Skew: -0.86
Kurtosis:  -0.82
</pre></div>
</div>
<img alt="_images/26e0c46a0598277a485fae7ff764e5af99676731f7a37b8fa1f395b43c79ef04.png" src="_images/26e0c46a0598277a485fae7ff764e5af99676731f7a37b8fa1f395b43c79ef04.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  v10
Skew: 17.65
Kurtosis:  476.4
</pre></div>
</div>
<img alt="_images/3976fb042eb85e8db8c8e2be767865c9ce927d6e98f461f8cf130f2d8ed188fd.png" src="_images/3976fb042eb85e8db8c8e2be767865c9ce927d6e98f461f8cf130f2d8ed188fd.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  v13
Skew: 0.33
Kurtosis:  4.91
</pre></div>
</div>
<img alt="_images/94022c4725a90a759d7fa1dfe3971e948c4cb48c07bc1ef7a371727074fba93a.png" src="_images/94022c4725a90a759d7fa1dfe3971e948c4cb48c07bc1ef7a371727074fba93a.png" />
</div>
</div>
<p>Realizamos un análisis a 4 variables independientes:</p>
<p>Para <strong>v1</strong>: Es casi simetrica, no tiene datos atípicos.
Para <strong>v2</strong>: La mediana está casi en el punto máximo, los datos están sesgados a la izquierda.
<strong>v10</strong>: Los datos se concentran a la derecha, teniendo datos atípicos en la cola izquierda.
<strong>v13</strong>: Los datos se concentran en el medio teniendo varios datos atípicos tanto a la izquierda como a a la derecha.</p>
<p><strong>Análisis Bivariado</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">df_treino</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">,</span> <span class="s1">&#39;v2&#39;</span><span class="p">,</span> <span class="s1">&#39;v10&#39;</span><span class="p">,</span> <span class="s1">&#39;v13&#39;</span><span class="p">,</span><span class="s1">&#39;v3&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8aa8de383437c7b7988c0b5fc5b88162c8ffc67de1c329d240a8c732a6d0f719.png" src="_images/8aa8de383437c7b7988c0b5fc5b88162c8ffc67de1c329d240a8c732a6d0f719.png" />
</div>
</div>
<p>Se realiza un análisis de la dispersión de las variables independientes vs la variable respuesta. Se puede observar como se dispersan los datos en cada una de las relaciones. Para verlo más al detalle y entender su relación analizamos los siguientes gráficos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bivar</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;v1&#39;</span><span class="p">,</span> <span class="s1">&#39;v3&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;v2&#39;</span><span class="p">,</span><span class="s1">&#39;v3&#39;</span><span class="p">),(</span><span class="s1">&#39;v10&#39;</span><span class="p">,</span><span class="s1">&#39;v3&#39;</span><span class="p">),(</span><span class="s1">&#39;v13&#39;</span><span class="p">,</span><span class="s1">&#39;v3&#39;</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">bivar</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_treino</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Scatterplot de </span><span class="si">{</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1"> vs </span><span class="si">{</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
 
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_treino</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span> <span class="s1">&#39;skyblue&#39;</span><span class="p">,</span> <span class="n">line_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span><span class="s2">&quot;blue&quot;</span><span class="p">})</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Regplot de </span><span class="si">{</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1"> vs </span><span class="si">{</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/db85055075c9583c1eb3bcd30e3fed4d5cfaa31b64839cd13d9c59a889a99671.png" src="_images/db85055075c9583c1eb3bcd30e3fed4d5cfaa31b64839cd13d9c59a889a99671.png" />
<img alt="_images/f0bd6259fbb36901bde5a535cb5c65d6ca972894c4f2b2db143ecbaa1e922d24.png" src="_images/f0bd6259fbb36901bde5a535cb5c65d6ca972894c4f2b2db143ecbaa1e922d24.png" />
<img alt="_images/c78b907e97ac7e42a6e5aa70ad86982cc281d396c0e9bca8ea8d64beb61e5901.png" src="_images/c78b907e97ac7e42a6e5aa70ad86982cc281d396c0e9bca8ea8d64beb61e5901.png" />
<img alt="_images/dd38dc3ca2268efe993583dc710fb424cb440ff115b9beb17aed83fb5ae9172b.png" src="_images/dd38dc3ca2268efe993583dc710fb424cb440ff115b9beb17aed83fb5ae9172b.png" />
<img alt="_images/34c5606069f65b6081c9ececb08bf66c46db081882a2bb8d46cffa9d5a214b81.png" src="_images/34c5606069f65b6081c9ececb08bf66c46db081882a2bb8d46cffa9d5a214b81.png" />
<img alt="_images/e54f5d3b399561fed76ed5a67b09bf198a7f49a73d6752552556aeff934f64d4.png" src="_images/e54f5d3b399561fed76ed5a67b09bf198a7f49a73d6752552556aeff934f64d4.png" />
<img alt="_images/ef001a4f90b1728305c9b0bcb77fcdc4ad7501d153fc1e508e9e95fd749dc5cc.png" src="_images/ef001a4f90b1728305c9b0bcb77fcdc4ad7501d153fc1e508e9e95fd749dc5cc.png" />
<img alt="_images/d0de8d407d83c43fab20a417e495dcb08f084c180bfaab227fd43e3ac9c0aa60.png" src="_images/d0de8d407d83c43fab20a417e495dcb08f084c180bfaab227fd43e3ac9c0aa60.png" />
</div>
</div>
<p>Con el análisis bivariado podemos comprender cómo se relacionan las variables entre sí y la relación entre las variables independientes presentes en el conjunto de datos  y para identificar patrones de tendencia lineal.</p>
<p>La parte principal del gráfico es un conjunto de puntos dispersos en un plano cartesiano. Cada punto representa un par de valores de dos variables diferentes que se comparan. La línea que atraviesa los puntos en el gráfico es la línea de regresión. Esta línea se ajusta a los datos de manera que represente la mejor estimación de la relación entre las dos variables. En un gráfico de dispersión, la línea de regresión se utiliza para modelar una posible tendencia lineal en los datos. La dirección de la línea de regresión indica si hay una relación positiva o negativa entre las dos variables. Si la línea sube hacia la derecha, hay una correlación positiva, lo que significa que cuando una variable aumenta, la otra también tiende a aumentar. Si la línea desciende hacia la derecha, hay una correlación negativa, lo que significa que cuando una variable aumenta, la otra tiende a disminuir.</p>
<p><strong>Imputación de datos faltantes con la mediana</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_treino</span> <span class="o">=</span> <span class="n">df_treino</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df_treino</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p><strong>VIF</strong></p>
<p>Se Realiza reducción de dimensionalidad por medio de eliminiación de columnas altamente correlacionadas usando Variance Inflation Factor (VIF)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.outliers_influence</span> <span class="kn">import</span> <span class="n">variance_inflation_factor</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculate_vif</span><span class="p">(</span><span class="n">data_frame</span><span class="p">):</span>
    <span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_frame</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">data_frame</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data_frame</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
    <span class="k">return</span> <span class="n">vif_data</span>

<span class="n">vif_result</span> <span class="o">=</span> <span class="n">calculate_vif</span><span class="p">(</span><span class="n">df_treino</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">,</span><span class="s1">&#39;v3&#39;</span><span class="p">]))</span>  <span class="c1"># Excluimos v3</span>
<span class="n">high_vif_cols</span> <span class="o">=</span> <span class="n">vif_result</span><span class="p">[</span><span class="n">vif_result</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">][</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span>
<span class="n">df_treino</span> <span class="o">=</span> <span class="n">df_treino</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">high_vif_cols</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Variables a eliminar con un VIF mayor o igual a 5</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">VIF5</span> <span class="o">=</span> <span class="n">vif_result</span><span class="p">[</span><span class="n">vif_result</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">VIF5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Variable            VIF
1        v4    1035.490461
2        v5     868.669868
3        v6    2431.219027
4        v7    2035.022178
5        v8     593.271593
6        v9  239633.065205
8       v11       7.476801
9       v12  944178.864436
10      v13  965371.723991
</pre></div>
</div>
</div>
</div>
<p>Se valida que las variables que quedan no tengan un VIF &gt;=5</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculate_vif</span><span class="p">(</span><span class="n">data_frame</span><span class="p">):</span>
    <span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_frame</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">data_frame</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data_frame</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
    <span class="k">return</span> <span class="n">vif_data</span>

<span class="n">vif_result</span> <span class="o">=</span> <span class="n">calculate_vif</span><span class="p">(</span><span class="n">df_treino</span><span class="p">)</span>
<span class="n">high_vif_cols</span> <span class="o">=</span> <span class="n">vif_result</span><span class="p">[</span><span class="n">vif_result</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">][</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">VIF5</span> <span class="o">=</span> <span class="n">vif_result</span><span class="p">[</span><span class="n">vif_result</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">VIF5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Empty DataFrame
Columns: [Variable, VIF]
Index: []
</pre></div>
</div>
</div>
</div>
<p>Finalmente, obtenemos un conjunto de datos depurados y listo para modelar:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_treino</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 87693 entries, 0 to 87692
Data columns (total 4 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   v1      87693 non-null  int32  
 1   v2      87693 non-null  float64
 2   v3      87693 non-null  float64
 3   v10     87693 non-null  float64
dtypes: float64(3), int32(1)
memory usage: 2.3 MB
</pre></div>
</div>
</div>
</div>
<p>Se reduce el DataFrame a (87693, 4)</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="ejercicio-6-modelos-de-regresion">
<h1>Ejercicio 6 - Modelos de Regresión<a class="headerlink" href="#ejercicio-6-modelos-de-regresion" title="Permalink to this heading">#</a></h1>
<p>Considere el conjunto de datos Wind Speed. Implemente la versión de regresión de cada uno de los modelos estudiados en clases, para predecir velocidad del viento horaria (VENTO, VELOCIDADE HORARIA (m/s)) en el conjunto de datos suministrado. Construir una tabla de error con las métricas usuales de regresión, MAPE, RMSE, R2 (ver Table 2). Realice particiones de entrenamiento y validación, con base en lo descrito en la Figura 1. Estas particiones siguen la tendencia de la velocidad del viento. Utilice la métrica RMSE en la evaluación y validación, para seleccionar el mejor modelo de regresión. El pliegue de validación en cada partición, debe estar siempre ubicado en el porcentaje final de cada partición, debido a que el tiempo es fundamental en dichas predicciones.</p>
<p><img alt="image.png" src="attachment:image.png" /></p>
<p>La idea era dividir el conjunto de datos en dos partes:</p>
<ol class="arabic simple">
<li><p>El 70% de los datos se utilizarán para el training y testing.</p></li>
<li><p>El 30% restante de los datos se implementarán para la validación de los modelos.</p></li>
</ol>
<p>Por temas de costo computacional, al hacer este ejercicio el modelo no me terminada. Por ender, realizaré el ejercicio para las primeras 480 hr.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Se realizará training para las primeras 480 horas de los datos del dataframe.</span>
<span class="n">df_train</span> <span class="o">=</span> <span class="n">df_treino</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">480</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">mean_absolute_percentage_error</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">Lasso</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Se define el número inicial de registros</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">24</span>
<span class="c1"># Define el número máximo de registros</span>
<span class="n">n_max</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_train</span><span class="p">)</span>
<span class="c1"># Se define un incremento para el número de registros en cada iteración</span>
<span class="n">incremento</span> <span class="o">=</span> <span class="mi">24</span>
<span class="c1"># Lista para almacenar los resultados de cada iteración</span>
<span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">while</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="n">n_max</span><span class="p">:</span>
    
    <span class="c1"># Seleccionamos los primeros n registros</span>
    <span class="n">df_n</span> <span class="o">=</span> <span class="n">df_treino</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span>

    <span class="n">X</span> <span class="o">=</span> <span class="n">df_n</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;v3&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">df_n</span><span class="p">[</span><span class="s1">&#39;v3&#39;</span><span class="p">]</span>

    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
    
    <span class="c1"># Se define la función para evaluar el modelo</span>
    <span class="k">def</span> <span class="nf">evaluate_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y_true</span><span class="p">):</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mape</span><span class="p">,</span> <span class="n">rmse</span><span class="p">,</span> <span class="n">r2</span>

    <span class="c1"># Se definen los modelos y pipelines</span>
    <span class="n">knn_model</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">()</span>
    <span class="n">ridge_model</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">()</span>
    <span class="n">lasso_model</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">()</span>
    <span class="n">xgboost_model</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">()</span>
    <span class="n">svm_model</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">()</span>
    <span class="n">mlp_model</span> <span class="o">=</span> <span class="n">MLPRegressor</span><span class="p">()</span>

    <span class="n">knn_pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
        <span class="p">(</span><span class="s1">&#39;knn&#39;</span><span class="p">,</span> <span class="n">KNeighborsRegressor</span><span class="p">())</span>
    <span class="p">])</span>

    <span class="n">ridge_pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
        <span class="p">(</span><span class="s1">&#39;ridge&#39;</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">())</span>
    <span class="p">])</span>

    <span class="n">lasso_pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
        <span class="p">(</span><span class="s1">&#39;lasso&#39;</span><span class="p">,</span> <span class="n">Lasso</span><span class="p">())</span>
    <span class="p">])</span>

    <span class="n">xgboost_pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;xgboost&#39;</span><span class="p">,</span> <span class="n">XGBRegressor</span><span class="p">())</span>
    <span class="p">])</span>

    <span class="n">svm_pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
        <span class="p">(</span><span class="s1">&#39;svm&#39;</span><span class="p">,</span> <span class="n">SVR</span><span class="p">())</span>
    <span class="p">])</span>

    <span class="n">mlp_pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
        <span class="p">(</span><span class="s1">&#39;mlp&#39;</span><span class="p">,</span> <span class="n">MLPRegressor</span><span class="p">())</span>
    <span class="p">])</span>

    <span class="c1"># Hiperparámetros para cada modelo</span>
    <span class="n">knn_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;knn__n_neighbors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
        <span class="s1">&#39;knn__weights&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="n">ridge_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;ridge__alpha&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="n">lasso_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;lasso__alpha&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="n">xgboost_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;xgboost__n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span>
        <span class="s1">&#39;xgboost__learning_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="n">svm_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;svm__kernel&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;rbf&#39;</span><span class="p">],</span>
        <span class="s1">&#39;svm__C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="n">mlp_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;mlp__hidden_layer_sizes&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="mi">50</span><span class="p">,),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)],</span>
        <span class="s1">&#39;mlp__max_iter&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="n">modelos</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;K-NN&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">knn_pipeline</span><span class="p">,</span> <span class="n">knn_params</span><span class="p">),</span>
        <span class="s1">&#39;Ridge&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">ridge_pipeline</span><span class="p">,</span> <span class="n">ridge_params</span><span class="p">),</span>
        <span class="s1">&#39;Lasso&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">lasso_pipeline</span><span class="p">,</span> <span class="n">lasso_params</span><span class="p">),</span>
        <span class="s1">&#39;XGBoost&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">xgboost_pipeline</span><span class="p">,</span> <span class="n">xgboost_params</span><span class="p">),</span>
        <span class="s1">&#39;SVM&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">svm_pipeline</span><span class="p">,</span> <span class="n">svm_params</span><span class="p">),</span>
        <span class="s1">&#39;MLP&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">mlp_pipeline</span><span class="p">,</span> <span class="n">mlp_params</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="n">resultados_modelos_iteracion</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span> <span class="ow">in</span> <span class="n">modelos</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;neg_mean_squared_error&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

        <span class="n">best_estimator</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_estimator_</span>

        <span class="c1"># Evaluar el modelo</span>
        <span class="n">mape</span><span class="p">,</span> <span class="n">rmse</span><span class="p">,</span> <span class="n">r2</span> <span class="o">=</span> <span class="n">evaluate_model</span><span class="p">(</span><span class="n">best_estimator</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

        <span class="n">resultados_modelos_iteracion</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;modelo&#39;</span><span class="p">:</span> <span class="n">model_name</span><span class="p">,</span>
            <span class="s1">&#39;mape&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
            <span class="s1">&#39;rmse&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
            <span class="s1">&#39;r2&#39;</span><span class="p">:</span> <span class="n">r2</span>
            <span class="p">})</span>

    <span class="c1"># Agrega los resultados de la iteración actual a la lista de resultados</span>
    <span class="n">resultados</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resultados_modelos_iteracion</span><span class="p">)</span>

    <span class="c1"># Incrementa el número de registros para la siguiente iteración</span>
    <span class="n">n</span> <span class="o">+=</span> <span class="n">incremento</span>

<span class="c1"># Calcula el promedio de los resultados por modelo</span>
<span class="n">promedios_modelos</span> <span class="o">=</span> <span class="p">{</span><span class="n">model_name</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;mape&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;rmse&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;r2&#39;</span><span class="p">:</span> <span class="p">[]}</span> <span class="k">for</span> <span class="n">model_name</span> <span class="ow">in</span> <span class="n">modelos</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>

<span class="k">for</span> <span class="n">resultados_iteracion</span> <span class="ow">in</span> <span class="n">resultados</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">resultado_modelo</span> <span class="ow">in</span> <span class="n">resultados_iteracion</span><span class="p">:</span>
        <span class="n">model_name</span> <span class="o">=</span> <span class="n">resultado_modelo</span><span class="p">[</span><span class="s1">&#39;modelo&#39;</span><span class="p">]</span>
        <span class="n">mape</span> <span class="o">=</span> <span class="n">resultado_modelo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mape&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">resultado_modelo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rmse&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> 
        <span class="n">r2</span> <span class="o">=</span> <span class="n">resultado_modelo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  
        
        <span class="k">if</span> <span class="n">mape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">promedios_modelos</span><span class="p">[</span><span class="n">model_name</span><span class="p">][</span><span class="s1">&#39;mape&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mape</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rmse</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">promedios_modelos</span><span class="p">[</span><span class="n">model_name</span><span class="p">][</span><span class="s1">&#39;rmse&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">promedios_modelos</span><span class="p">[</span><span class="n">model_name</span><span class="p">][</span><span class="s1">&#39;r2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span>
            
            
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\joblib\parallel.py:975,</span> in <span class="ni">Parallel.retrieve</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">974</span> <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="p">,</span> <span class="s1">&#39;supports_timeout&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">975</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_output</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">job</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">976</span> <span class="k">else</span><span class="p">:</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\joblib\_parallel_backends.py:567,</span> in <span class="ni">LokyBackend.wrap_future_result</span><span class="nt">(future, timeout)</span>
<span class="g g-Whitespace">    </span><span class="mi">566</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">567</span>     <span class="k">return</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">568</span> <span class="k">except</span> <span class="n">CfTimeoutError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\concurrent\futures\_base.py:441,</span> in <span class="ni">Future.result</span><span class="nt">(self, timeout)</span>
<span class="g g-Whitespace">    </span><span class="mi">439</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_result</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">441</span> <span class="bp">self</span><span class="o">.</span><span class="n">_condition</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">443</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state</span> <span class="ow">in</span> <span class="p">[</span><span class="n">CANCELLED</span><span class="p">,</span> <span class="n">CANCELLED_AND_NOTIFIED</span><span class="p">]:</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\threading.py:312,</span> in <span class="ni">Condition.wait</span><span class="nt">(self, timeout)</span>
<span class="g g-Whitespace">    </span><span class="mi">311</span> <span class="k">if</span> <span class="n">timeout</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">312</span>     <span class="n">waiter</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">313</span>     <span class="n">gotit</span> <span class="o">=</span> <span class="kc">True</span>

<span class="ne">KeyboardInterrupt</span>: 

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">OSError</span><span class="g g-Whitespace">                                   </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">27</span><span class="p">],</span> <span class="n">line</span> <span class="mi">98</span>
<span class="g g-Whitespace">     </span><span class="mi">96</span> <span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span> <span class="ow">in</span> <span class="n">modelos</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="g g-Whitespace">     </span><span class="mi">97</span>     <span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;neg_mean_squared_error&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">98</span>     <span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">100</span>     <span class="n">best_estimator</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_estimator_</span>
<span class="g g-Whitespace">    </span><span class="mi">102</span>     <span class="c1"># Evaluar el modelo</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\sklearn\base.py:1151,</span> in <span class="ni">_fit_context.&lt;locals&gt;.decorator.&lt;locals&gt;.wrapper</span><span class="nt">(estimator, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1144</span>     <span class="n">estimator</span><span class="o">.</span><span class="n">_validate_params</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1146</span> <span class="k">with</span> <span class="n">config_context</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1147</span>     <span class="n">skip_parameter_validation</span><span class="o">=</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1148</span>         <span class="n">prefer_skip_nested_validation</span> <span class="ow">or</span> <span class="n">global_skip_validation</span>
<span class="g g-Whitespace">   </span><span class="mi">1149</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1150</span> <span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1151</span>     <span class="k">return</span> <span class="n">fit_method</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\sklearn\model_selection\_search.py:898,</span> in <span class="ni">BaseSearchCV.fit</span><span class="nt">(self, X, y, groups, **fit_params)</span>
<span class="g g-Whitespace">    </span><span class="mi">892</span>     <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_results</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">893</span>         <span class="n">all_candidate_params</span><span class="p">,</span> <span class="n">n_splits</span><span class="p">,</span> <span class="n">all_out</span><span class="p">,</span> <span class="n">all_more_results</span>
<span class="g g-Whitespace">    </span><span class="mi">894</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">896</span>     <span class="k">return</span> <span class="n">results</span>
<span class="ne">--&gt; </span><span class="mi">898</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_search</span><span class="p">(</span><span class="n">evaluate_candidates</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">900</span> <span class="c1"># multimetric is determined here because in the case of a callable</span>
<span class="g g-Whitespace">    </span><span class="mi">901</span> <span class="c1"># self.scoring the return type is only known after calling</span>
<span class="g g-Whitespace">    </span><span class="mi">902</span> <span class="n">first_test_score</span> <span class="o">=</span> <span class="n">all_out</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;test_scores&quot;</span><span class="p">]</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\sklearn\model_selection\_search.py:1419,</span> in <span class="ni">GridSearchCV._run_search</span><span class="nt">(self, evaluate_candidates)</span>
<span class="g g-Whitespace">   </span><span class="mi">1417</span> <span class="k">def</span> <span class="nf">_run_search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evaluate_candidates</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1418</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Search all candidates in param_grid&quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1419</span>     <span class="n">evaluate_candidates</span><span class="p">(</span><span class="n">ParameterGrid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_grid</span><span class="p">))</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\sklearn\model_selection\_search.py:845,</span> in <span class="ni">BaseSearchCV.fit.&lt;locals&gt;.evaluate_candidates</span><span class="nt">(candidate_params, cv, more_results)</span>
<span class="g g-Whitespace">    </span><span class="mi">837</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">838</span>     <span class="nb">print</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">839</span>         <span class="s2">&quot;Fitting </span><span class="si">{0}</span><span class="s2"> folds for each of </span><span class="si">{1}</span><span class="s2"> candidates,&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">840</span>         <span class="s2">&quot; totalling </span><span class="si">{2}</span><span class="s2"> fits&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">841</span>             <span class="n">n_splits</span><span class="p">,</span> <span class="n">n_candidates</span><span class="p">,</span> <span class="n">n_candidates</span> <span class="o">*</span> <span class="n">n_splits</span>
<span class="g g-Whitespace">    </span><span class="mi">842</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">843</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">845</span> <span class="n">out</span> <span class="o">=</span> <span class="n">parallel</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">846</span>     <span class="n">delayed</span><span class="p">(</span><span class="n">_fit_and_score</span><span class="p">)(</span>
<span class="g g-Whitespace">    </span><span class="mi">847</span>         <span class="n">clone</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">848</span>         <span class="n">X</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">849</span>         <span class="n">y</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">850</span>         <span class="n">train</span><span class="o">=</span><span class="n">train</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">851</span>         <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">852</span>         <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">853</span>         <span class="n">split_progress</span><span class="o">=</span><span class="p">(</span><span class="n">split_idx</span><span class="p">,</span> <span class="n">n_splits</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">854</span>         <span class="n">candidate_progress</span><span class="o">=</span><span class="p">(</span><span class="n">cand_idx</span><span class="p">,</span> <span class="n">n_candidates</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">855</span>         <span class="o">**</span><span class="n">fit_and_score_kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">856</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">857</span>     <span class="k">for</span> <span class="p">(</span><span class="n">cand_idx</span><span class="p">,</span> <span class="n">parameters</span><span class="p">),</span> <span class="p">(</span><span class="n">split_idx</span><span class="p">,</span> <span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">))</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">858</span>         <span class="nb">enumerate</span><span class="p">(</span><span class="n">candidate_params</span><span class="p">),</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">groups</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">859</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">860</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">862</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">863</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">864</span>         <span class="s2">&quot;No fits were performed. &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">865</span>         <span class="s2">&quot;Was the CV iterator empty? &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">866</span>         <span class="s2">&quot;Were there no candidates?&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">867</span>     <span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\sklearn\utils\parallel.py:65,</span> in <span class="ni">Parallel.__call__</span><span class="nt">(self, iterable)</span>
<span class="g g-Whitespace">     </span><span class="mi">60</span> <span class="n">config</span> <span class="o">=</span> <span class="n">get_config</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">61</span> <span class="n">iterable_with_config</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">62</span>     <span class="p">(</span><span class="n">_with_config</span><span class="p">(</span><span class="n">delayed_func</span><span class="p">,</span> <span class="n">config</span><span class="p">),</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">63</span>     <span class="k">for</span> <span class="n">delayed_func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="ow">in</span> <span class="n">iterable</span>
<span class="g g-Whitespace">     </span><span class="mi">64</span> <span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">65</span> <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">iterable_with_config</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\joblib\parallel.py:1098,</span> in <span class="ni">Parallel.__call__</span><span class="nt">(self, iterable)</span>
<span class="g g-Whitespace">   </span><span class="mi">1095</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_iterating</span> <span class="o">=</span> <span class="kc">False</span>
<span class="g g-Whitespace">   </span><span class="mi">1097</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">retrieval_context</span><span class="p">():</span>
<span class="ne">-&gt; </span><span class="mi">1098</span>     <span class="bp">self</span><span class="o">.</span><span class="n">retrieve</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1099</span> <span class="c1"># Make sure that we get a last message telling us we are done</span>
<span class="g g-Whitespace">   </span><span class="mi">1100</span> <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_time</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\joblib\parallel.py:997,</span> in <span class="ni">Parallel.retrieve</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">991</span> <span class="k">if</span> <span class="p">(</span><span class="n">backend</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>
<span class="g g-Whitespace">    </span><span class="mi">992</span>         <span class="nb">hasattr</span><span class="p">(</span><span class="n">backend</span><span class="p">,</span> <span class="s1">&#39;abort_everything&#39;</span><span class="p">)):</span>
<span class="g g-Whitespace">    </span><span class="mi">993</span>     <span class="c1"># If the backend is managed externally we need to make sure</span>
<span class="g g-Whitespace">    </span><span class="mi">994</span>     <span class="c1"># to leave it in a working state to allow for future jobs</span>
<span class="g g-Whitespace">    </span><span class="mi">995</span>     <span class="c1"># scheduling.</span>
<span class="g g-Whitespace">    </span><span class="mi">996</span>     <span class="n">ensure_ready</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_managed_backend</span>
<span class="ne">--&gt; </span><span class="mi">997</span>     <span class="n">backend</span><span class="o">.</span><span class="n">abort_everything</span><span class="p">(</span><span class="n">ensure_ready</span><span class="o">=</span><span class="n">ensure_ready</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">998</span> <span class="k">raise</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\joblib\_parallel_backends.py:590,</span> in <span class="ni">LokyBackend.abort_everything</span><span class="nt">(self, ensure_ready)</span>
<span class="g g-Whitespace">    </span><span class="mi">587</span> <span class="bp">self</span><span class="o">.</span><span class="n">_workers</span> <span class="o">=</span> <span class="kc">None</span>
<span class="g g-Whitespace">    </span><span class="mi">589</span> <span class="k">if</span> <span class="n">ensure_ready</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">590</span>     <span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\joblib\_parallel_backends.py:506,</span> in <span class="ni">LokyBackend.configure</span><span class="nt">(self, n_jobs, parallel, prefer, require, idle_worker_timeout, **memmappingexecutor_args)</span>
<span class="g g-Whitespace">    </span><span class="mi">502</span> <span class="k">if</span> <span class="n">n_jobs</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">503</span>     <span class="k">raise</span> <span class="n">FallbackToBackend</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">504</span>         <span class="n">SequentialBackend</span><span class="p">(</span><span class="n">nesting_level</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nesting_level</span><span class="p">))</span>
<span class="ne">--&gt; </span><span class="mi">506</span> <span class="bp">self</span><span class="o">.</span><span class="n">_workers</span> <span class="o">=</span> <span class="n">get_memmapping_executor</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">507</span>     <span class="n">n_jobs</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">idle_worker_timeout</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">508</span>     <span class="n">env</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_prepare_worker_env</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">509</span>     <span class="n">context_id</span><span class="o">=</span><span class="n">parallel</span><span class="o">.</span><span class="n">_id</span><span class="p">,</span> <span class="o">**</span><span class="n">memmappingexecutor_args</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">510</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel</span> <span class="o">=</span> <span class="n">parallel</span>
<span class="g g-Whitespace">    </span><span class="mi">511</span> <span class="k">return</span> <span class="n">n_jobs</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\joblib\executor.py:20,</span> in <span class="ni">get_memmapping_executor</span><span class="nt">(n_jobs, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">19</span> <span class="k">def</span> <span class="nf">get_memmapping_executor</span><span class="p">(</span><span class="n">n_jobs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">20</span>     <span class="k">return</span> <span class="n">MemmappingExecutor</span><span class="o">.</span><span class="n">get_memmapping_executor</span><span class="p">(</span><span class="n">n_jobs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\joblib\executor.py:42,</span> in <span class="ni">MemmappingExecutor.get_memmapping_executor</span><span class="nt">(cls, n_jobs, timeout, initializer, initargs, env, temp_folder, context_id, **backend_args)</span>
<span class="g g-Whitespace">     </span><span class="mi">39</span> <span class="n">reuse</span> <span class="o">=</span> <span class="n">_executor_args</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">_executor_args</span> <span class="o">==</span> <span class="n">executor_args</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span> <span class="n">_executor_args</span> <span class="o">=</span> <span class="n">executor_args</span>
<span class="ne">---&gt; </span><span class="mi">42</span> <span class="n">manager</span> <span class="o">=</span> <span class="n">TemporaryResourcesManager</span><span class="p">(</span><span class="n">temp_folder</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">44</span> <span class="c1"># reducers access the temporary folder in which to store temporary</span>
<span class="g g-Whitespace">     </span><span class="mi">45</span> <span class="c1"># pickles through a call to manager.resolve_temp_folder_name. resolving</span>
<span class="g g-Whitespace">     </span><span class="mi">46</span> <span class="c1"># the folder name dynamically is useful to use different folders across</span>
<span class="g g-Whitespace">     </span><span class="mi">47</span> <span class="c1"># calls of a same reusable executor</span>
<span class="g g-Whitespace">     </span><span class="mi">48</span> <span class="n">job_reducers</span><span class="p">,</span> <span class="n">result_reducers</span> <span class="o">=</span> <span class="n">get_memmapping_reducers</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">49</span>     <span class="n">unlink_on_gc_collect</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">50</span>     <span class="n">temp_folder_resolver</span><span class="o">=</span><span class="n">manager</span><span class="o">.</span><span class="n">resolve_temp_folder_name</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">51</span>     <span class="o">**</span><span class="n">backend_args</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\joblib\_memmapping_reducer.py:535,</span> in <span class="ni">TemporaryResourcesManager.__init__</span><span class="nt">(self, temp_folder_root, context_id)</span>
<span class="g g-Whitespace">    </span><span class="mi">529</span> <span class="k">if</span> <span class="n">context_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">530</span>     <span class="c1"># It would be safer to not assign a default context id (less silent</span>
<span class="g g-Whitespace">    </span><span class="mi">531</span>     <span class="c1"># bugs), but doing this while maintaining backward compatibility</span>
<span class="g g-Whitespace">    </span><span class="mi">532</span>     <span class="c1"># with the previous, context-unaware version get_memmaping_executor</span>
<span class="g g-Whitespace">    </span><span class="mi">533</span>     <span class="c1"># exposes exposes too many low-level details.</span>
<span class="g g-Whitespace">    </span><span class="mi">534</span>     <span class="n">context_id</span> <span class="o">=</span> <span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span>
<span class="ne">--&gt; </span><span class="mi">535</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_current_context</span><span class="p">(</span><span class="n">context_id</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\joblib\_memmapping_reducer.py:539,</span> in <span class="ni">TemporaryResourcesManager.set_current_context</span><span class="nt">(self, context_id)</span>
<span class="g g-Whitespace">    </span><span class="mi">537</span> <span class="k">def</span> <span class="nf">set_current_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context_id</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">538</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_current_context_id</span> <span class="o">=</span> <span class="n">context_id</span>
<span class="ne">--&gt; </span><span class="mi">539</span>     <span class="bp">self</span><span class="o">.</span><span class="n">register_new_context</span><span class="p">(</span><span class="n">context_id</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\joblib\_memmapping_reducer.py:564,</span> in <span class="ni">TemporaryResourcesManager.register_new_context</span><span class="nt">(self, context_id)</span>
<span class="g g-Whitespace">    </span><span class="mi">557</span> <span class="n">new_folder_name</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">558</span>     <span class="s2">&quot;joblib_memmapping_folder_</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">559</span>         <span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_id</span><span class="p">,</span> <span class="n">context_id</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">560</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">561</span> <span class="n">new_folder_path</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">_get_temp_dir</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">562</span>     <span class="n">new_folder_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temp_folder_root</span>
<span class="g g-Whitespace">    </span><span class="mi">563</span> <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">564</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_folder_finalizer</span><span class="p">(</span><span class="n">new_folder_path</span><span class="p">,</span> <span class="n">context_id</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">565</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_temp_folders</span><span class="p">[</span><span class="n">context_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_folder_path</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\joblib\_memmapping_reducer.py:594,</span> in <span class="ni">TemporaryResourcesManager.register_folder_finalizer</span><span class="nt">(self, pool_subfolder, context_id)</span>
<span class="g g-Whitespace">    </span><span class="mi">587</span> <span class="k">def</span> <span class="nf">register_folder_finalizer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pool_subfolder</span><span class="p">,</span> <span class="n">context_id</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">588</span>     <span class="c1"># Register the garbage collector at program exit in case caller forgets</span>
<span class="g g-Whitespace">    </span><span class="mi">589</span>     <span class="c1"># to call terminate explicitly: note we do not pass any reference to</span>
<span class="g g-Whitespace">    </span><span class="mi">590</span>     <span class="c1"># ensure that this callback won&#39;t prevent garbage collection of</span>
<span class="g g-Whitespace">    </span><span class="mi">591</span>     <span class="c1"># parallel instance and related file handler resources such as POSIX</span>
<span class="g g-Whitespace">    </span><span class="mi">592</span>     <span class="c1"># semaphores and pipes</span>
<span class="g g-Whitespace">    </span><span class="mi">593</span>     <span class="n">pool_module_name</span> <span class="o">=</span> <span class="n">whichmodule</span><span class="p">(</span><span class="n">delete_folder</span><span class="p">,</span> <span class="s1">&#39;delete_folder&#39;</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">594</span>     <span class="n">resource_tracker</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">pool_subfolder</span><span class="p">,</span> <span class="s2">&quot;folder&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">596</span>     <span class="k">def</span> <span class="nf">_cleanup</span><span class="p">():</span>
<span class="g g-Whitespace">    </span><span class="mi">597</span>         <span class="c1"># In some cases the Python runtime seems to set delete_folder to</span>
<span class="g g-Whitespace">    </span><span class="mi">598</span>         <span class="c1"># None just before exiting when accessing the delete_folder</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">603</span>         <span class="c1"># because joblib should only use relative imports to allow</span>
<span class="g g-Whitespace">    </span><span class="mi">604</span>         <span class="c1"># easy vendoring.</span>
<span class="g g-Whitespace">    </span><span class="mi">605</span>         <span class="n">delete_folder</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">606</span>             <span class="n">pool_module_name</span><span class="p">,</span> <span class="n">fromlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;delete_folder&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">delete_folder</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\joblib\externals\loky\backend\resource_tracker.py:178,</span> in <span class="ni">ResourceTracker.register</span><span class="nt">(self, name, rtype)</span>
<span class="g g-Whitespace">    </span><span class="mi">176</span> <span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">rtype</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">177</span><span class="w">     </span><span class="sd">&#39;&#39;&#39;Register a named resource, and increment its refcount.&#39;&#39;&#39;</span>
<span class="ne">--&gt; </span><span class="mi">178</span>     <span class="bp">self</span><span class="o">.</span><span class="n">ensure_running</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">179</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_send</span><span class="p">(</span><span class="s1">&#39;REGISTER&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">rtype</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\joblib\externals\loky\backend\resource_tracker.py:99,</span> in <span class="ni">ResourceTracker.ensure_running</span><span class="nt">(self)</span>
<span class="g g-Whitespace">     </span><span class="mi">96</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">97</span>     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">98</span>         <span class="c1"># resource tracker was launched before, is it still running?</span>
<span class="ne">---&gt; </span><span class="mi">99</span>         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_alive</span><span class="p">():</span>
<span class="g g-Whitespace">    </span><span class="mi">100</span>             <span class="c1"># =&gt; still alive</span>
<span class="g g-Whitespace">    </span><span class="mi">101</span>             <span class="k">return</span>
<span class="g g-Whitespace">    </span><span class="mi">102</span>         <span class="c1"># =&gt; dead, launch it again</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\joblib\externals\loky\backend\resource_tracker.py:170,</span> in <span class="ni">ResourceTracker._check_alive</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">168</span><span class="w"> </span><span class="sd">&#39;&#39;&#39;Check for the existence of the resource tracker process.&#39;&#39;&#39;</span>
<span class="g g-Whitespace">    </span><span class="mi">169</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">170</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_send</span><span class="p">(</span><span class="s1">&#39;PROBE&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">171</span> <span class="k">except</span> <span class="ne">BrokenPipeError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">172</span>     <span class="k">return</span> <span class="kc">False</span>

<span class="nn">File ~\miniconda3\envs\ml_venv\lib\site-packages\joblib\externals\loky\backend\resource_tracker.py:197,</span> in <span class="ni">ResourceTracker._send</span><span class="nt">(self, cmd, name, rtype)</span>
<span class="g g-Whitespace">    </span><span class="mi">195</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;name too long&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">196</span> <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cmd</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">rtype</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">197</span> <span class="n">nbytes</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fd</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">198</span> <span class="k">assert</span> <span class="n">nbytes</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

<span class="ne">OSError</span>: [Errno 22] Invalid argument
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calcula los promedios finales</span>
<span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">metrics</span> <span class="ow">in</span> <span class="n">promedios_modelos</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">rmse_prom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">])</span>
    <span class="n">mape_prom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;mape&#39;</span><span class="p">])</span>
    <span class="n">r2_prom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;r2&#39;</span><span class="p">])</span>
    <span class="n">e_promedio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Modelo: </span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE Promedio: </span><span class="si">{</span><span class="n">mape_prom</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE Promedio: </span><span class="si">{</span><span class="n">rmse_prom</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;R2 Promedio: </span><span class="si">{</span><span class="n">r2_prom</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Modelo: K-NN
MAPE Promedio: 178705258638984.8
RMSE Promedio: 0.7663401530725045
R2 Promedio: 0.4186477678570788

Modelo: Ridge
MAPE Promedio: 212968947215849.9
RMSE Promedio: 0.8732216954119038
R2 Promedio: 0.24584514475120534

Modelo: Lasso
MAPE Promedio: 239783458933358.34
RMSE Promedio: 0.885598891553015
R2 Promedio: 0.23253629794465702

Modelo: XGBoost
MAPE Promedio: 264887417393443.25
RMSE Promedio: 0.8465685412506957
R2 Promedio: 0.300979978319488

Modelo: SVM
MAPE Promedio: 172427738491182.44
RMSE Promedio: 0.7554698196688598
R2 Promedio: 0.42991001842914905

Modelo: MLP
MAPE Promedio: 167100578256291.94
RMSE Promedio: 0.7596113113291129
R2 Promedio: 0.4281551941199161
</pre></div>
</div>
</div>
</div>
<p>MAPE: Esta métrica mide el error porcentual medio absoluto entre las predicciones del modelo y los valores reales.</p>
<p>RMSE: Esta métrica mide la raíz cuadrada del promedio de los errores al cuadrado entre las predicciones del modelo y los valores reales. Al igual que el MAPE, un RMSE más bajo indica un mejor rendimiento del modelo.</p>
<p>R^2: Esta métrica proporciona una medida de la calidad de las predicciones del modelo en comparación con las predicciones simples de la media. Un valor R^2 más cercano a 1 indica un mejor ajuste del modelo a los datos.</p>
<p>El mejor modelo utilizando la métrica RMSE (el promedio de las particiones) es:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Encuentra el mejor modelo según el RMSE promedio</span>
<span class="n">mejor_modelo</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">mejor_rmse_promedio</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">modelo</span><span class="p">,</span> <span class="n">promedios</span> <span class="ow">in</span> <span class="n">promedios_modelos</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">rmse_promedio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">promedios</span><span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">rmse_promedio</span> <span class="o">&lt;</span> <span class="n">mejor_rmse_promedio</span><span class="p">:</span>
        <span class="n">mejor_rmse_promedio</span> <span class="o">=</span> <span class="n">rmse_promedio</span>
        <span class="n">mejor_modelo</span> <span class="o">=</span> <span class="n">modelo</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;El mejor modelo es </span><span class="si">{</span><span class="n">mejor_modelo</span><span class="si">}</span><span class="s2"> con un RMSE promedio de </span><span class="si">{</span><span class="n">mejor_rmse_promedio</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>El mejor modelo es SVM con un RMSE promedio de 0.76
</pre></div>
</div>
</div>
</div>
<section id="validacion-mejor-modelo">
<h2>Validación Mejor Modelo<a class="headerlink" href="#validacion-mejor-modelo" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_test</span><span class="o">=</span> <span class="n">df_n</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">240</span><span class="p">:]</span> 
<span class="n">df_test</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>v1</th>
      <th>v2</th>
      <th>v3</th>
      <th>v10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>240</th>
      <td>12</td>
      <td>-0.809017</td>
      <td>2.1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>241</th>
      <td>13</td>
      <td>-0.920505</td>
      <td>1.9</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>242</th>
      <td>14</td>
      <td>-0.438371</td>
      <td>1.9</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>243</th>
      <td>15</td>
      <td>-0.017452</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>244</th>
      <td>16</td>
      <td>0.656059</td>
      <td>2.5</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">joblib</span>

<span class="c1"># Guardar el mejor modelo</span>
<span class="n">nombre_archivo_modelo</span> <span class="o">=</span> <span class="s2">&quot;mejor_modelo_rmse.pkl&quot;</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">nombre_archivo_modelo</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">archivo</span><span class="p">:</span>
    <span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">grid_search</span><span class="p">,</span> <span class="n">archivo</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;El mejor modelo (</span><span class="si">{</span><span class="n">mejor_modelo</span><span class="si">}</span><span class="s2">) se ha guardado en </span><span class="si">{</span><span class="n">nombre_archivo_modelo</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>El mejor modelo (SVM) se ha guardado en mejor_modelo_rmse.pkl
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar el modelo desde el archivo</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">nombre_archivo_modelo</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">archivo</span><span class="p">:</span>
    <span class="n">modelo_cargado</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">archivo</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Preparar los nuevos datos de la misma manera que se hizo para el modelo original (X_nuevos)</span>
<span class="n">X_nuevos</span> <span class="o">=</span> <span class="n">df_test</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;v3&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_nuevos</span> <span class="o">=</span> <span class="n">df_test</span><span class="p">[</span><span class="s1">&#39;v3&#39;</span><span class="p">]</span>

<span class="c1"># Realizar predicciones en los nuevos datos</span>
<span class="n">predicciones</span> <span class="o">=</span> <span class="n">modelo_cargado</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_nuevos</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mape_nuevos</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_nuevos</span><span class="p">,</span> <span class="n">predicciones</span><span class="p">)</span>  <span class="c1"># Asegúrate de tener &quot;y_nuevos&quot; definido</span>
<span class="n">rmse_nuevos</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_nuevos</span><span class="p">,</span> <span class="n">predicciones</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Asegúrate de tener &quot;y_nuevos&quot; definido</span>
<span class="n">r2_nuevos</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_nuevos</span><span class="p">,</span> <span class="n">predicciones</span><span class="p">)</span>  <span class="c1"># Asegúrate de tener &quot;y_nuevos&quot; definido</span>

<span class="c1"># Imprimir los resultados promedio de MAPE, RMSE y R^2 para los nuevos datos</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE para nuevos datos: </span><span class="si">{</span><span class="n">mape_nuevos</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE para nuevos datos: </span><span class="si">{</span><span class="n">rmse_nuevos</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;R^2 para nuevos datos: </span><span class="si">{</span><span class="n">r2_nuevos</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAPE para nuevos datos: 108111530474677.06
RMSE para nuevos datos: 0.86
R^2 para nuevos datos: 0.45
</pre></div>
</div>
</div>
</div>
<p>MAPE: Es una métrica que mide el error promedio en términos de porcentaje absoluto entre las predicciones del modelo y los valores reales. En este caso, un MAPE extremadamente alto de 108111530474677.06 indica un rendimiento muy pobre del modelo en la predicción de los nuevos datos. Un MAPE tan alto sugiere que las predicciones del modelo están muy lejos de los valores reales y que el modelo no es adecuado para estos datos.</p>
<p>RMSE: Es una métrica que mide el error promedio en términos de unidades de la variable objetivo. En este caso, un RMSE de 0.86 es relativamente bajo, lo que sugiere que las predicciones del modelo tienen un buen ajuste en términos de unidades de la variable objetivo. Sin embargo, dado el alto MAPE mencionado anteriormente, esto podría ser engañoso. El RMSE solo tiene en cuenta la magnitud de los errores, pero no considera la dirección de los errores.</p>
<p>R^2 : El R^2 (coeficiente de determinación) es una métrica que indica cuánta variabilidad en la variable objetivo se explica por el modelo. Un valor de R^2 de 0.45 sugiere que el modelo explica aproximadamente el 45% de la variabilidad en los nuevos datos. Esto significa que el modelo tiene cierta capacidad predictiva, pero aún queda una cantidad significativa de variabilidad que no se explica.</p>
<p>En resumen, los resultados indican que el modelo tiene un alto MAPE, lo que sugiere que las predicciones son muy inexactas en términos de porcentaje absoluto. El RMSE es relativamente bajo en comparación con el MAPE, pero el R^2 indica que el modelo no explica una gran parte de la variabilidad en los nuevos datos. En general, el modelo parece tener limitaciones significativas en la predicción de los nuevos datos y podría necesitar mejoras.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Welcome to your Jupyter Book</p>
      </div>
    </a>
    <a class="right-next"
       href="Fraud%20Detection.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Ejericio 4 - EDA</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">WIND SPEED</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-4-eda">Ejercicio 4 - EDA</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-6-modelos-de-regresion">Ejercicio 6 - Modelos de Regresión</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#validacion-mejor-modelo">Validación Mejor Modelo</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Andrés Vargas Humánez
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>